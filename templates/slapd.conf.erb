# Server Configuration
pidfile  /var/run/slapd/slapd.pid
argsfile /var/run/slapd/slapd.args
loglevel <%= @log_level %>

<% if @bind_anon == true -%>
# Allow anonymous bind
allow bind_anon_dn
<% end -%>

<% if @bind_v2 == true -%>
# Allow LDAPv2
allow bind_v2
<% end -%>

# Schemas
<% @schemas.each do |name| -%>
include /etc/ldap/schema/<%= name %>.schema
<% end -%>

# Modules
<% @modules.each do |name| -%>
moduleload <%= name %>
<% end -%>

<% if @ssl == true -%>
# SSL
TLSCACertificateFile   <%= @ssl_ca %>
TLSCertificateFile     <%= @ssl_cert %>
TLSCertificateKeyFile  <%= @ssl_key %>
<% end -%>

# Database definition
database  bdb
directory <%= @directory %>
suffix    "<%= @suffix %>"
rootdn    "<%= @rootdn %>"
rootpw    "<%= @rootpw %>"

# Indexes
<% @indexes.each do |name| -%>
index <%= name %>
<% end -%>

# Database parameters 
cachesize 10000
checkpoint 128 15
